<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- ========================
         PRIMARY META + SEO
         ======================== -->
    <title>Free JPG to PDF Converter | Fast, Secure & 100% Client-Side</title>

    <meta name="description" content="Convert JPG, PNG & HEIC to a single PDF instantly. 100% client-side (no uploads), private, and fast. Arrange pages, choose orientation and download ‚Äî free." />
    <meta name="keywords" content="jpg to pdf, convert jpg to pdf, image to pdf, png to pdf, heic to pdf, offline jpg to pdf, client side pdf converter, free jpg to pdf" />
    <meta name="author" content="ImagePDF.Pro" />
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large" />
    <link rel="canonical" href="https://imagepdf.pro/" />

    <!-- ========================
         SOCIAL PREVIEW (Open Graph / Twitter)
         ======================== -->
    <meta property="og:site_name" content="ImagePDF.Pro" />
    <meta property="og:title" content="Free JPG to PDF Converter | Fast, Secure & 100% Client-Side" />
    <meta property="og:description" content="Convert JPG, PNG & HEIC to PDF instantly. No uploads ‚Äî processing happens in your browser for maximum privacy." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://imagepdf.pro/" />
    <!-- Replace with your hosted preview image -->
    <meta property="og:image" content="https://imagepdf.pro/og.jpg" />
    <meta property="og:image:alt" content="Preview ‚Äî JPG to PDF in browser" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Free JPG to PDF Converter ‚Äî Fast & Private" />
    <meta name="twitter:description" content="Convert JPG, PNG & HEIC to PDF instantly ‚Äî fully client-side. Arrange pages, set orientation & download securely." />
    <meta name="twitter:image" content="https://imagepdf.pro/og.jpg" />

    <!-- ========================
         PERFORMANCE / UX
         ======================== -->
    <!-- Preload a modern webfont (if you host one) -->
    <!-- <link rel="preload" href="/fonts/inter-regular.woff2" as="font" type="font/woff2" crossorigin> -->

    <!-- Minimal critical CSS kept inline for speed (keeps the page fast). Larger CSS could be external for caching. -->
    <style>
        /* (Same CSS as before, slightly condensed for brevity) */
        :root { --color-primary:#007AFF; --color-secondary:#00C4CC; --color-background:#F8F9FA; --color-surface:#FFFFFF; --color-dark:#212529; --color-muted:#6C757D; --color-success:#28A745; --color-error:#DC3545; }
        *{margin:0;padding:0;box-sizing:border-box;scroll-behavior:smooth}
        body{font-family:Inter, 'Segoe UI', Arial, sans-serif;background:var(--color-background);color:var(--color-dark);line-height:1.6;display:flex;flex-direction:column;min-height:100vh}
        .trust-bar{background:var(--color-success);color:var(--color-surface);padding:8px 0;text-align:center;font-size:.9em;font-weight:600}
        .site-header{background:var(--color-surface);padding:15px 0;box-shadow:0 2px 4px rgba(0,0,0,.05);position:sticky;top:0;z-index:1000}
        .header-content{max-width:1200px;margin:0 auto;padding:0 30px;display:flex;justify-content:space-between;align-items:center}
        .logo{font-size:1.6em;font-weight:800;color:var(--color-primary);cursor:pointer;letter-spacing:-.5px}
        nav a{color:var(--color-dark);text-decoration:none;margin-left:30px;font-weight:500;transition:color .3s}
        nav a:hover{color:var(--color-primary)}
        .content-wrapper{flex-grow:1}
        .converter-section{max-width:850px;margin:50px auto;padding:30px;width:95%;background:var(--color-surface);border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.1);border:1px solid #EAEAEA}
        .drop-area{border:2px dashed var(--color-primary);background:#F9FBFF;padding:60px 20px;text-align:center;border-radius:10px;transition:background-color .3s,border-color .3s;cursor:pointer}
        .drag-text{font-size:2em;font-weight:700;color:var(--color-dark);margin-bottom:10px;display:flex;align-items:center;justify-content:center;gap:15px}
        .file-icon{font-size:2.2em;color:var(--color-primary)}
        .or-text{margin:15px 0;color:var(--color-muted);font-style:italic}
        .button-group{display:flex;justify-content:center;flex-wrap:wrap;gap:20px;margin-top:20px}
        .select-btn,.clear-btn{border:none;padding:15px 35px;font-size:1.1em;border-radius:8px;font-weight:600;cursor:pointer;box-shadow:0 4px 6px rgba(0,0,0,.1)}
        .select-btn{background:var(--color-primary);color:var(--color-surface)}
        .convert-area{margin-top:30px}
        .convert-btn{background-image:linear-gradient(to right,var(--color-secondary),var(--color-primary));color:var(--color-surface);border:none;padding:20px 30px;font-size:1.4em;font-weight:bold;border-radius:10px;width:100%;cursor:pointer;box-shadow:0 8px 15px rgba(0,122,255,.3)}
        .preview-area{display:flex;flex-wrap:wrap;gap:12px;padding:15px 0;margin-top:20px;justify-content:center;border-top:1px solid #F0F0F0}
        .preview-item{width:80px;height:80px;border:2px solid var(--color-secondary);border-radius:8px;overflow:hidden;position:relative;cursor:grab;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 5px rgba(0,0,0,.1)}
        .filename-label{position:absolute;bottom:0;width:100%;text-align:center;background:rgba(0,122,255,.8);font-size:.65em;padding:2px 0;color:var(--color-surface);font-weight:600}
        .remove-file-btn{position:absolute;top:-5px;right:-5px;background:var(--color-error);color:var(--color-surface);border:1px solid var(--color-surface);border-radius:50%;width:20px;height:20px;font-size:14px;line-height:1;cursor:pointer;font-weight:900}
        .instructions-section,.faq-section,.supporting-section{max-width:1000px;margin:0 auto;padding:60px 20px}
        .steps-container{display:flex;justify-content:space-around;gap:30px;text-align:center}
        .step{flex:1;background:var(--color-surface);padding:30px 20px;border-radius:10px;border-bottom:3px solid var(--color-primary);box-shadow:0 4px 10px rgba(0,0,0,.05)}
        .faq-question{background:var(--color-surface);padding:15px 20px;font-weight:600;cursor:pointer}
        .faq-answer{background:#F8F9FA;padding:0 20px;max-height:0;overflow:hidden;transition:max-height .4s,padding .4s;color:var(--color-muted)}
        .site-footer{background:var(--color-dark);color:var(--color-muted);padding:20px 0;text-align:center;margin-top:auto;font-size:.9em;border-top:3px solid var(--color-primary)}
        @media(max-width:768px){.converter-section{margin:30px auto 20px;padding:15px}.drag-text{font-size:1.5em}.convert-btn{padding:15px 20px;font-size:1.2em}.steps-container{flex-direction:column}.site-header nav{overflow-x:scroll}.site-header nav a{font-size:.85em;margin:0 5px}}
    </style>

    <!-- ========================
         Canonical / Robots / Sitemap (inform search engines)
         (Create the referenced files on your server)
         ======================== -->
    <link rel="alternate" href="https://imagepdf.pro/" hreflang="en" />
    <link rel="sitemap" type="application/xml" href="/sitemap.xml" />
    <meta name="google-site-verification" content="" />

    <!-- Load jsPDF asynchronously for performance (fallback kept) -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div class="trust-bar" aria-hidden="false">
        üîí <strong>100% Client-Side Processing.</strong> Your files are processed in-browser only ‚Äî no upload.
    </div>

    <header class="site-header" role="banner">
        <div class="header-content">
            <h2 class="logo" onclick="showSection('home')" aria-label="Client PDF Home">Client PDF</h2>
            <nav role="navigation" aria-label="Main navigation">
                <a href="#home-section" onclick="showSection('home')">Home</a>
                <a href="#about-tools-section" onclick="showSection('about-tools')">Features</a>
                <a href="#privacy-section" onclick="showSection('privacy')">Security</a>
                <a href="#contact-section" onclick="showSection('contact')">Support</a>
            </nav>
        </div>
    </header>

    <main class="content-wrapper" id="main">
        <!-- MAIN HERO / TOOL -->
        <section id="home-section" class="active" aria-labelledby="main-heading">
            <main class="converter-section" role="application" aria-label="JPG to PDF converter">
                <!-- Primary Heading (one H1) -->
                <h1 id="main-heading" style="font-size:1.5em;margin-bottom:18px">Free JPG to PDF Converter ‚Äî Fast, Secure & 100% Client-Side</h1>

                <div class="drop-area" id="dropArea" onclick="document.getElementById('fileInput').click()" role="button" aria-label="Drop images here or click to select">
                    <h2 class="drag-text">
                        <span class="file-icon" aria-hidden="true">üìÅ</span>
                        Drag &amp; Drop Your Images Here
                    </h2>
                    <p class="or-text">OR</p>
                    <input type="file" id="fileInput" accept="image/*" multiple style="display:none" aria-label="Select images" />

                    <div class="button-group">
                        <button class="select-btn" onclick="event.stopPropagation(); document.getElementById('fileInput').click()" aria-label="Select images">Select Images (JPG, PNG, HEIC)</button>
                        <button class="clear-btn" id="clearBtn" disabled onclick="event.stopPropagation(); clearFiles()" aria-label="Clear file list">Clear List</button>
                    </div>

                    <p class="file-count" id="fileCount">No files selected. Start converting!</p>
                </div>

                <div id="previewArea" class="preview-area" aria-live="polite"></div>

                <div class="convert-area" style="margin-top:18px">
                    <button class="convert-btn" id="convertBtn" disabled aria-disabled="true">Convert to PDF (0 Images)</button>

                    <button class="advanced-settings-btn" id="settingsToggleBtn" aria-expanded="false" aria-controls="settingsPanel">Page & Output Settings</button>

                    <div id="settingsPanel" class="settings-panel" style="display:none" role="region" aria-hidden="true">
                        <label for="pageOrientation">PDF Orientation:</label>
                        <select id="pageOrientation">
                            <option value="p">Portrait (Default)</option>
                            <option value="l">Landscape</option>
                        </select>

                        <label for="pageSize">PDF Page Size:</label>
                        <select id="pageSize">
                            <option value="a4">A4 (Default)</option>
                            <option value="letter">Letter</option>
                        </select>

                        <label for="imageScale">Image Scaling:</label>
                        <select id="imageScale">
                            <option value="fit">Fit to Page (Best Fit)</option>
                            <option value="original">Original Size</option>
                        </select>
                    </div>

                    <div id="progressBarContainer" class="progress-bar-container" style="display:none" aria-hidden="true">
                        <div id="progressBar" class="progress-bar" style="width:0%"></div>
                    </div>

                    <div id="statusArea" class="status-area" style="display:none" role="status" aria-live="polite"></div>
                </div>
            </main>

            <!-- Short instructions to add topical text for SEO -->
            <section id="how-to" class="instructions-section" aria-labelledby="how-to-heading">
                <h2 id="how-to-heading">Convert images to PDF quickly ‚Äî how it works</h2>
                <p style="text-align:center;color:var(--color-muted);max-width:850px;margin:0 auto 20px">
                    This offline tool converts JPG, PNG and HEIC images into a single PDF directly in your browser. No upload, fast conversion and full privacy.
                </p>
                <div class="steps-container" role="list">
                    <div class="step" role="listitem">
                        <span class="step-number" style="background:var(--color-secondary);color:#fff;border-radius:50%;width:45px;height:45px;display:inline-flex;align-items:center;justify-content:center">1</span>
                        <h3>Drop Files</h3>
                        <p>Drag or click to select image files from your device.</p>
                    </div>
                    <div class="step" role="listitem">
                        <span class="step-number" style="background:var(--color-secondary);color:#fff;border-radius:50%;width:45px;height:45px;display:inline-flex;align-items:center;justify-content:center">2</span>
                        <h3>Arrange & Configure</h3>
                        <p>Reorder previews and choose orientation & page size in settings.</p>
                    </div>
                    <div class="step" role="listitem">
                        <span class="step-number" style="background:var(--color-secondary);color:#fff;border-radius:50%;width:45px;height:45px;display:inline-flex;align-items:center;justify-content:center">3</span>
                        <h3>Download</h3>
                        <p>Press convert ‚Äî your PDF downloads immediately.</p>
                    </div>
                </div>
            </section>

            <section id="faq" class="faq-section" aria-labelledby="faq-heading">
                <h2 id="faq-heading">Frequently Asked Questions</h2>
                <div class="faq-container" id="faqContainer">
                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFAQ(this)" role="button" tabindex="0">Is this service truly secure and private? <span class="arrow">‚ñº</span></div>
                        <div class="faq-answer">
                            <p><strong>Absolutely.</strong> This tool runs entirely in your browser (client-side). Your files are not uploaded or stored.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFAQ(this)" role="button" tabindex="0">What image formats can I convert? <span class="arrow">‚ñº</span></div>
                        <div class="faq-answer">
                            <p>We support JPG/JPEG, PNG and HEIC.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFAQ(this)" role="button" tabindex="0">Are there any limits? <span class="arrow">‚ñº</span></div>
                        <div class="faq-answer">
                            <p>Because processing happens in-browser, limits depend on your device‚Äôs memory and CPU. There are no server limits.</p>
                        </div>
                    </div>
                </div>
            </section>
        </section>

        <hr />

        <!-- ABOUT / TECHNOLOGY SECTION (helps with topical authority & keywords) -->
        <section id="about-tools-section" class="supporting-section">
            <h2>Why Client-Side Conversion?</h2>
            <p>Client-side conversion ensures speed and privacy. This solution uses the jsPDF library to create PDFs directly in your browser ‚Äî no files leave your device.</p>
            <h3>Benefits</h3>
            <ul>
                <li>No uploads or server storage</li>
                <li>Fast conversion ‚Äî limited only by device performance</li>
                <li>Works offline once loaded</li>
            </ul>
        </section>

        <hr />

        <section id="privacy-section" class="supporting-section">
            <h2>Data Security & Privacy</h2>
            <p><strong>Your privacy is our priority.</strong> All files are processed locally in your web browser and removed from memory when the page reloads or you clear the list.</p>
        </section>

        <hr />

        <section id="contact-section" class="supporting-section">
            <h2>Get Support</h2>
            <p>For support or feedback: <a href="mailto:clientpdf1@gmail.com">support@clientpdf.com</a></p>
        </section>
    </main>

    <footer class="site-footer" role="contentinfo">
        <p>&copy; 2024 <strong>ImagePDF.Pro</strong> | Built with client-side technology for maximum privacy.</p>
        <p>Contact: <a href="mailto:clientpdf1@gmail.com" style="color:inherit">support@clientpdf.com</a></p>
    </footer>

    <!-- ========================
         STRUCTURED DATA (JSON-LD)
         Helps search engines understand content & can enable rich results
         ======================== -->
    <script type="application/ld+json">
    {
      "@context":"https://schema.org",
      "@graph":[
        {
          "@type":"WebSite",
          "url":"https://imagepdf.pro/",
          "name":"ImagePDF.Pro",
          "potentialAction":{"@type":"SearchAction","target":"https://imagepdf.pro/?s={search_term_string}","query-input":"required name=search_term_string"}
        },
        {
          "@type":"WebApplication",
          "name":"ClientPDF",
          "url":"https://imagepdf.pro/",
          "description":"Convert JPG, PNG and HEIC images to PDF instantly in your browser. No uploads ‚Äî 100% client-side.",
          "applicationCategory":"Utility",
          "operatingSystem":"Web Browser",
          "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"}
        },
        {
          "@type":"FAQPage",
          "mainEntity":[
            {
              "@type":"Question",
              "name":"Is this service truly secure?",
              "acceptedAnswer":{"@type":"Answer","text":"Yes ‚Äî it's 100% client-side. Files are never uploaded."}
            },
            {
              "@type":"Question",
              "name":"Which formats are supported?",
              "acceptedAnswer":{"@type":"Answer","text":"JPG, PNG, HEIC are supported."}
            }
          ]
        }
      ]
    }
    </script>

    <!-- ========================
         SITE-SPECIFIC SCRIPTS (defer for performance)
         ======================== -->
    <script>
        // Use window.jspdf if loaded from CDN
        const { jsPDF } = window.jspdf || {};

        // DOM elements
        const fileInput = document.getElementById('fileInput');
        const dropArea = document.getElementById('dropArea');
        const convertBtn = document.getElementById('convertBtn');
        const clearBtn = document.getElementById('clearBtn');
        const fileCount = document.getElementById('fileCount');
        const statusArea = document.getElementById('statusArea');
        const previewArea = document.getElementById('previewArea');
        const progressBarContainer = document.getElementById('progressBarContainer');
        const progressBar = document.getElementById('progressBar');

        const settingsToggleBtn = document.getElementById('settingsToggleBtn');
        const settingsPanel = document.getElementById('settingsPanel');
        const pageOrientationSelect = document.getElementById('pageOrientation');
        const pageSizeSelect = document.getElementById('pageSize');
        const imageScaleSelect = document.getElementById('imageScale');

        // sections
        const homeSection = document.getElementById('home-section');
        const aboutSection = document.getElementById('about-tools-section');
        const privacySection = document.getElementById('privacy-section');
        const contactSection = document.getElementById('contact-section');
        const faqSection = document.getElementById('faq');
        const allSections = [homeSection, aboutSection, privacySection, contactSection];

        // state
        let filesToConvert = [];
        let fileIdCounter = 0;
        let dragStartIndex = -1;

        // navigation
        function showSection(sectionId) {
            allSections.forEach(s => s.classList.remove('active'));
            let target;
            if (sectionId === 'home') { homeSection.classList.add('active'); target = homeSection; }
            else if (sectionId === 'about-tools') { aboutSection.classList.add('active'); target = aboutSection; }
            else if (sectionId === 'privacy') { privacySection.classList.add('active'); target = privacySection; }
            else if (sectionId === 'contact') { contactSection.classList.add('active'); target = contactSection; }
            if (target) target.scrollIntoView({behavior:'smooth', block:'start'});
        }
        window.showSection = showSection;

        // FAQ toggle
        function toggleFAQ(element) {
            const answer = element.nextElementSibling;
            const isActive = element.classList.toggle('active');
            answer.style.maxHeight = isActive ? answer.scrollHeight + 30 + "px" : null;
            element.scrollIntoView({behavior:'smooth', block:'nearest'});
        }
        window.toggleFAQ = toggleFAQ;

        // settings toggle
        settingsToggleBtn.addEventListener('click', () => {
            const isVisible = settingsPanel.style.display === 'block';
            settingsPanel.style.display = isVisible ? 'none' : 'block';
            settingsToggleBtn.innerText = isVisible ? 'Page & Output Settings' : 'Hide Settings';
            settingsToggleBtn.setAttribute('aria-expanded', String(!isVisible));
            settingsPanel.setAttribute('aria-hidden', String(isVisible));
        });

        function updateFileStatus() {
            const count = filesToConvert.length;
            fileCount.textContent = count > 0 ? `${count} file(s) loaded. Drag previews to reorder.` : 'No files selected. Start converting!';
            convertBtn.textContent = count > 0 ? `Convert to PDF (${count} Images)` : 'Convert to PDF (0 Images)';
            convertBtn.disabled = count === 0;
            convertBtn.setAttribute('aria-disabled', String(count === 0));
            clearBtn.disabled = count === 0;
            renderPreviews();
        }

        // preview and reorder
        function handleDragStart(e, index) {
            dragStartIndex = index;
            e.dataTransfer.setData('text/plain', index);
            e.currentTarget.style.opacity = '0.5';
        }

        function handleDropReorder(e, dropIndex) {
            e.preventDefault();
            e.currentTarget.style.border = '2px solid var(--color-secondary)';
            const dragIndex = dragStartIndex;
            if (dragIndex === -1 || dragIndex === dropIndex) return;
            const [draggedItem] = filesToConvert.splice(dragIndex, 1);
            filesToConvert.splice(dropIndex, 0, draggedItem);
            updateFileStatus();
        }

        function removeFile(fileId) {
            filesToConvert = filesToConvert.filter(item => item.id !== fileId);
            updateFileStatus();
        }

        function renderPreviews() {
            previewArea.innerHTML = '';
            statusArea.style.display = 'none';
            filesToConvert.forEach((item, index) => {
                const file = item.file;
                const reader = new FileReader();
                reader.onload = function(event) {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'preview-item';
                    itemDiv.setAttribute('data-file-id', item.id);
                    itemDiv.draggable = true;
                    itemDiv.ondragstart = e => handleDragStart(e, index);
                    itemDiv.ondragover = e => e.preventDefault();
                    itemDiv.ondrop = e => handleDropReorder(e, index);
                    itemDiv.ondragenter = e => itemDiv.style.border = '2px solid var(--color-primary)';
                    itemDiv.ondragleave = e => itemDiv.style.border = '2px solid var(--color-secondary)';

                    const img = document.createElement('img');
                    img.src = event.target.result;
                    img.alt = file.name ? `Preview of ${file.name}` : 'Image preview';
                    img.loading = 'lazy'; // accessibility + performance
                    img.style.width = '100%';
                    img.style.height = '100%';
                    img.style.objectFit = 'cover';

                    const label = document.createElement('div');
                    label.className = 'filename-label';
                    label.textContent = `Page ${index + 1}`;

                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'remove-file-btn';
                    removeBtn.textContent = 'X';
                    removeBtn.title = 'Remove file';
                    removeBtn.onclick = (e) => { e.stopPropagation(); removeFile(item.id); };

                    itemDiv.appendChild(img);
                    itemDiv.appendChild(label);
                    itemDiv.appendChild(removeBtn);
                    previewArea.appendChild(itemDiv);
                };
                reader.readAsDataURL(file);
            });
            previewArea.style.display = filesToConvert.length > 0 ? 'flex' : 'none';
        }

        // convert logic
        async function convertImagesToPdf() {
            if (filesToConvert.length === 0) return;

            // ensure jsPDF available
            if (typeof window.jspdf === 'undefined') {
                alert('PDF library not loaded. Please try again or check your connection.');
                return;
            }
            const { jsPDF } = window.jspdf;

            const orientation = pageOrientationSelect.value;
            const size = pageSizeSelect.value;
            const scale = imageScaleSelect.value;

            statusArea.textContent = `Starting conversion... ${size.toUpperCase()} / ${orientation.toUpperCase()}`;
            statusArea.style.display = 'block';
            progressBarContainer.style.display = 'block';
            progressBar.style.width = '0%';
            convertBtn.disabled = true;
            clearBtn.disabled = true;

            const pdf = new jsPDF(orientation, 'mm', size);
            let firstPage = true;

            for (let i = 0; i < filesToConvert.length; i++) {
                const fileItem = filesToConvert[i];
                const file = fileItem.file;

                const reader = new FileReader();
                progressBar.style.width = `${Math.round((i / filesToConvert.length) * 100)}%`;
                statusArea.textContent = `Processing image ${i + 1} of ${filesToConvert.length}: Reading...`;

                await new Promise((resolve) => {
                    reader.onload = function(event) {
                        const imgData = event.target.result;
                        const img = new Image();
                        img.onload = function() {
                            statusArea.textContent = `Adding image ${i + 1} to PDF...`;

                            const imgWidth = img.width;
                            const imgHeight = img.height;

                            let pdfWidth = pdf.internal.pageSize.getWidth();
                            let pdfHeight = pdf.internal.pageSize.getHeight();

                            let newWidth, newHeight, x, y;

                            if (scale === 'fit') {
                                const widthRatio = pdfWidth / imgWidth;
                                const heightRatio = pdfHeight / imgHeight;
                                const ratio = Math.min(widthRatio, heightRatio);
                                newWidth = imgWidth * ratio;
                                newHeight = imgHeight * ratio;
                                x = (pdfWidth - newWidth) / 2;
                                y = (pdfHeight - newHeight) / 2;
                            } else {
                                newWidth = imgWidth * 0.264583;
                                newHeight = imgHeight * 0.264583;
                                x = (pdfWidth - newWidth) / 2;
                                y = (pdfHeight - newHeight) / 2;
                            }

                            if (!firstPage) { pdf.addPage(); } else { firstPage = false; }

                            // pick image format; default to JPEG if unsupported
                            const format = (file.type && file.type.split('/')[1]) ? file.type.split('/')[1].toUpperCase() : 'JPEG';
                            try {
                                pdf.addImage(imgData, format, x, y, newWidth, newHeight);
                            } catch (e) {
                                // fallback to JPEG
                                pdf.addImage(imgData, 'JPEG', x, y, newWidth, newHeight);
                            }
                            resolve();
                        };
                        img.onerror = function() { console.error('Image load error', file.name); resolve(); };
                        img.src = imgData;
                    };
                    reader.onerror = function() { console.error('File read error', file.name); resolve(); };
                    reader.readAsDataURL(file);
                });
            }

            progressBar.style.width = '100%';
            statusArea.textContent = 'Finalizing PDF...';

            pdf.save(`ImagePDF.Pro_Output.pdf`);

            statusArea.textContent = '‚úÖ Conversion complete. Your PDF has been downloaded.';
            progressBarContainer.style.display = 'none';
            convertBtn.disabled = false;
            clearBtn.disabled = false;
        }

        // initialization & utilities
        function processFiles(fileList) {
            const newFiles = Array.from(fileList).filter(file => file.type && file.type.startsWith('image/'));
            newFiles.forEach(file => {
                filesToConvert.push({ file, id: fileIdCounter++ });
            });
            updateFileStatus();
        }

        function clearFiles() {
            filesToConvert = [];
            fileInput.value = '';
            updateFileStatus();
            statusArea.textContent = '';
            statusArea.style.display = 'none';
            progressBarContainer.style.display = 'none';
            settingsPanel.style.display = 'none';
            settingsToggleBtn.innerText = 'Page & Output Settings';
            settingsToggleBtn.setAttribute('aria-expanded', 'false');
        }

        // event listeners
        fileInput.addEventListener('change', e => processFiles(e.target.files));
        convertBtn.addEventListener('click', convertImagesToPdf);
        clearBtn.addEventListener('click', clearFiles);

        ['dragenter','dragover','dragleave','drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, e => {
                e.preventDefault(); e.stopPropagation();
                if (eventName === 'dragenter' || eventName === 'dragover') dropArea.classList.add('drag-over');
                else dropArea.classList.remove('drag-over');
            }, false);
        });

        dropArea.addEventListener('drop', e => {
            dropArea.classList.remove('drag-over');
            const dt = e.dataTransfer;
            processFiles(dt.files);
        }, false);

        // initial state
        updateFileStatus();
    </script>
</body>
</html>
